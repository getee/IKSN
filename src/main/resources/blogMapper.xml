<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">



<mapper namespace="group.first.iksn.model.dao.BlogDAO">
    <select id="detailedBlogSearchResultMap" resultMap="searchResultMap">


    </select>

    <insert id="processAddBlog" parameterType="Blog" useGeneratedKeys="true" keyColumn="bid">
        insert into blog(title,content,time,classify) values (#{title},#{content},#{time},#{classify})
    </insert>
     <!--定义的一个reaultmap结果集合来存储关联查询到的详细的博客，类型是自定义类型-->
    <resultMap id="searchResultMap" type="Blog">

    </resultMap>
    <!--向illegalblog表中插入违规博客信息-->
    <insert id="addIllegalblog" parameterType="IllegalBlog">
        insert into illegalblog(bid,illegalcause) values (#{bid},#{illegalcause})
    </insert>
    <!--从illegalblog表中获取所有博客信息-->
    <select id="getAllReportBlog111" resultType="IllegalBlog">
        select * from illegalblog
    </select>
    <!--从reportBlog表中根据id删除一个选中行-->
    <delete id="deleteBlogFromReport" parameterType="ReportBlog">
      delete from reportblog where id = #{id}
    </delete>

    <!--结果集合用来存储查询ReportBlog表级联查询blog表-->
    <resultMap id="getBlogBy_Reportbid" type="ReportBlog">
        <id column="id" property="id"/>
        <result column="uid" property="uid"/>
        <result column="reason" property="reason"/>

        <association property="blog" column="bid" javaType="Blog">
            <id column="bid" property="bid"/>
            <result column="title" property="title"/>
        </association>
    </resultMap>
    <select id="getAllReportBlog" resultMap="getBlogBy_Reportbid">
		select  i.ID,i.BID,i.REASON,b.TITLE  from reportblog as i
		inner join blog as b on   i.BID=b.BID ORDER BY i.ID desc limit 0,3;
	</select>
</mapper>